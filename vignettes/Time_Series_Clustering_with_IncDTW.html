<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Leodolter Maximilian" />

<meta name="date" content="2019-11-15" />

<title>Time Series Clustering with IncDTW</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Time Series Clustering with IncDTW</h1>
<h4 class="author">Leodolter Maximilian</h4>
<h4 class="date">2019-11-15</h4>



<!-- % https://colinfay.me/writing-r-extensions/writing-r-documentation-files.html -->
<p>This vignette demonstrates how to cluster time series of equal or different lengths based on the DTW (Dynamic Time Warping) distance measure. <!-- In the following examples we use DTW as distance measure to cluster a set of time series to find prototypical patterns.  --> First we calculate the symmetric matrix of pairwise DTW distances by applying the function <code>IncDTW::dtw_dismat</code>.</p>
<p>Next we apply hierarchical clustering <code>fastcluster::hclust</code> to cluster the distance matrix.</p>
<p>Finally we represent the found clusters by prototypical time series. However it is not trivial to average time series that are non-linearly aligned. Unlike to averaging time series of equal lengths with 1-1 alignment by Euclidean distance, we cannot simply calculate the mean of two time series, instead we apply <code>IncDTW::dba</code> – an implementation of the DBA algorithm (DTW Barycenter Averaging), proposed by <span class="citation">Petitjean, Ketterlin, and Gançarski (2011)</span> – to achieve a more meaningful representative of a cluster.</p>
<p>In the following experiments we work with data sets <span class="citation">Bruno et al. (2013)</span> downloaded from UCI machine learning repository <span class="citation">Dheeru and Karra Taniskidou (2017)</span>. The data was collected by participants wearing a smart watch recording a 3-dimensional accelerometer signal with a sampling rate of 32 Hz. Among other actions the participants were asked to collect data during walking (<code>Walk</code>), drinking a glass (<code>drink_glass</code>) and brushing teeth (<code>brush_teeth</code>). The time series data of these experiments are included in the package <code>IncDTW</code>.</p>
<p>    <!-- ========================================================================================== --> <!-- ========================================================================================== --></p>
<div id="clustering-time-series-of-equal-lengths" class="section level2">
<h2>Clustering time series of equal lengths</h2>
<!-- ========================================================================================== -->
<!-- ========================================================================================== -->
<p>In this example we cluster the accelerometer time series of walking and brushing teeth. We select these two data sets, since both activities show patterns of high frequencies. So, for these two activities we assume to find short distinct prototype patterns that occur repeatedly in longer time series of the respective activities.</p>
<p>First we cut the time series of 3-dimensional accelerometer recordings of walking and brushing teeth into non-overlapping snippets of 5 seconds each – which is equal to 160 observations – and normalize these snippets and store them as list of time series, `lot}.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">get_snippets &lt;-<span class="st"> </span><span class="cf">function</span>(lot, <span class="dt">N =</span> <span class="dv">0</span>){</a>
<a class="sourceLine" id="cb1-2" title="2">   <span class="cf">if</span>(N <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>){</a>
<a class="sourceLine" id="cb1-3" title="3">      lot &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(lot), <span class="cf">function</span>(j){</a>
<a class="sourceLine" id="cb1-4" title="4">         x &lt;-<span class="st"> </span>lot[[j]]</a>
<a class="sourceLine" id="cb1-5" title="5">         sid &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="kw">nrow</span>(x)<span class="op">-</span>N, <span class="dt">by =</span> N)</a>
<a class="sourceLine" id="cb1-6" title="6">         d0 &lt;-<span class="st"> </span><span class="kw">lapply</span>(sid, <span class="cf">function</span>(i){</a>
<a class="sourceLine" id="cb1-7" title="7">            x[i<span class="op">:</span>(i<span class="op">+</span>N<span class="dv">-1</span>), ]</a>
<a class="sourceLine" id="cb1-8" title="8">         })</a>
<a class="sourceLine" id="cb1-9" title="9">         info &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">lot_id =</span> j, <span class="dt">snippet_id =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(sid), </a>
<a class="sourceLine" id="cb1-10" title="10">                          <span class="dt">ibegin =</span> sid, <span class="dt">iend =</span> sid <span class="op">+</span><span class="st"> </span>N <span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb1-11" title="11">         <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">data =</span> d0, <span class="dt">info =</span> info))</a>
<a class="sourceLine" id="cb1-12" title="12">      })</a>
<a class="sourceLine" id="cb1-13" title="13">      data &lt;-<span class="st"> </span><span class="kw">do.call</span>(c, <span class="kw">lapply</span>(lot, <span class="st">&quot;[[&quot;</span>, <span class="st">&quot;data&quot;</span>))</a>
<a class="sourceLine" id="cb1-14" title="14">      info &lt;-<span class="st"> </span><span class="kw">do.call</span>(rbind, <span class="kw">lapply</span>(lot, <span class="st">&quot;[[&quot;</span>, <span class="st">&quot;info&quot;</span>))</a>
<a class="sourceLine" id="cb1-15" title="15">      info<span class="op">$</span>runid &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(info)</a>
<a class="sourceLine" id="cb1-16" title="16">   }  </a>
<a class="sourceLine" id="cb1-17" title="17">   </a>
<a class="sourceLine" id="cb1-18" title="18">   data &lt;-<span class="st"> </span><span class="kw">lapply</span>(data, IncDTW<span class="op">::</span>scale)</a>
<a class="sourceLine" id="cb1-19" title="19">   <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">data =</span> data, <span class="dt">info =</span> info))</a>
<a class="sourceLine" id="cb1-20" title="20">}</a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">data</span>(<span class="st">&quot;walk&quot;</span>)</a>
<a class="sourceLine" id="cb2-2" title="2">datax &lt;-<span class="st"> </span>walk</a>
<a class="sourceLine" id="cb2-3" title="3">lot &lt;-<span class="st"> </span><span class="kw">get_snippets</span>(datax, <span class="dt">N =</span> <span class="dv">5</span> <span class="op">*</span><span class="st"> </span><span class="dv">32</span>)</a>
<a class="sourceLine" id="cb2-4" title="4">nw &lt;-<span class="st"> </span><span class="kw">length</span>(lot<span class="op">$</span>data)</a>
<a class="sourceLine" id="cb2-5" title="5"></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="kw">data</span>(<span class="st">&quot;brush_teeth&quot;</span>)</a>
<a class="sourceLine" id="cb2-7" title="7">datax &lt;-<span class="st"> </span>brush_teeth</a>
<a class="sourceLine" id="cb2-8" title="8">lot2 &lt;-<span class="st"> </span><span class="kw">get_snippets</span>(datax, <span class="dt">N =</span> <span class="dv">5</span> <span class="op">*</span><span class="st"> </span><span class="dv">32</span>)</a>
<a class="sourceLine" id="cb2-9" title="9">nb &lt;-<span class="st"> </span><span class="kw">length</span>(lot2<span class="op">$</span>data)</a>
<a class="sourceLine" id="cb2-10" title="10"></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="co"># get both activities in one list</span></a>
<a class="sourceLine" id="cb2-12" title="12">lot<span class="op">$</span>data &lt;-<span class="st"> </span><span class="kw">c</span>(lot<span class="op">$</span>data, lot2<span class="op">$</span>data)</a>
<a class="sourceLine" id="cb2-13" title="13">lot2<span class="op">$</span>info<span class="op">$</span>runid &lt;-<span class="st"> </span>lot2<span class="op">$</span>info<span class="op">$</span>runid <span class="op">+</span><span class="st"> </span>nw</a>
<a class="sourceLine" id="cb2-14" title="14">lot2<span class="op">$</span>info<span class="op">$</span>lot_id &lt;-<span class="st"> </span>lot2<span class="op">$</span>info<span class="op">$</span>lot_id <span class="op">+</span><span class="st"> </span><span class="kw">max</span>(lot<span class="op">$</span>info<span class="op">$</span>lot_id)</a>
<a class="sourceLine" id="cb2-15" title="15">lot<span class="op">$</span>info &lt;-<span class="st"> </span><span class="kw">rbind</span>(lot<span class="op">$</span>info, lot2<span class="op">$</span>info)</a></code></pre></div>
<p>Then we calculate the distance matrix with <code>dtw_dismat</code> for all 707 snippets (we skip shorter snippets at the end of the records). The symmetric distance matrix has <code>N(N-1)/2 = 249571</code> entries in the lower triangular matrix to be calculated. To shorten the calculation time <code>dtw_dismat</code> distributes the work per default among all minus one available nodes via <code>RcppPrallel</code> <span class="citation">Allaire et al. (2018)</span>. Per default <code>dtw_dismat</code> returns the distance matrix as a <code>dist</code> object, which can easily be passed to standard clustering functions, as e.g., hierarchical clustering:</p>
<p>The evaluation of the following takes about 2-3 minutes:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">dm &lt;-<span class="st"> </span><span class="kw">dtw_dismat</span>(lot<span class="op">$</span>data, <span class="dt">dist_method =</span> <span class="st">&quot;norm2&quot;</span>, <span class="dt">return_matrix =</span> <span class="ot">FALSE</span>, <span class="dt">ws =</span> <span class="dv">10</span>, </a>
<a class="sourceLine" id="cb3-2" title="2">              <span class="dt">step_pattern =</span> <span class="st">&quot;symmetric2&quot;</span>, <span class="dt">normalize =</span> <span class="ot">TRUE</span> )</a>
<a class="sourceLine" id="cb3-3" title="3">agn &lt;-<span class="st"> </span>fastcluster<span class="op">::</span><span class="kw">hclust</span>(dm<span class="op">$</span>dismat, <span class="dt">method =</span> <span class="st">&quot;average&quot;</span>)</a></code></pre></div>
<p>For compatibility <code>dtw_dismat</code> returns the distance matrix as object of class <code>dist</code>, which is one of the standard classes accepted by traditional clustering functions like <code>hclust</code>, <code>agnes</code> or <code>pam</code> of the packages <code>cluster</code> by <span class="citation">Maechler et al. (2018)</span> and <code>fastcluster</code> by <span class="citation">Müllner (2013)</span>, for hierarchical clustering, agglomerative hierarchical clustering and partitioning around medoids, respectively.</p>
<p>To find <code>k</code>, the best number of clusters (which is analog to the height where to cut the dendrogram), we evaluated the normalized mutual information (NMI) for all <code>k=2:30</code>, and found that for <code>k = 8</code> the best clustering is found with an NMI of about 0.55.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">entr &lt;-<span class="st"> </span><span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb4-2" title="2">   counts &lt;-<span class="st"> </span><span class="kw">table</span>(x)</a>
<a class="sourceLine" id="cb4-3" title="3">   probs &lt;-<span class="st"> </span>counts<span class="op">/</span><span class="kw">length</span>(x) </a>
<a class="sourceLine" id="cb4-4" title="4">   <span class="op">-</span><span class="st"> </span><span class="kw">sum</span>(probs <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(probs, <span class="dt">base=</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb4-5" title="5">}</a>
<a class="sourceLine" id="cb4-6" title="6"></a>
<a class="sourceLine" id="cb4-7" title="7">con_entr &lt;-<span class="st"> </span><span class="cf">function</span>(C, Y){</a>
<a class="sourceLine" id="cb4-8" title="8">   <span class="co"># conditinal entropy</span></a>
<a class="sourceLine" id="cb4-9" title="9">   tmp &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="kw">unique</span>(C), <span class="cf">function</span>(cc){</a>
<a class="sourceLine" id="cb4-10" title="10">      pcc &lt;-<span class="st"> </span><span class="kw">sum</span>(C <span class="op">==</span><span class="st"> </span>cc)<span class="op">/</span><span class="kw">length</span>(C)</a>
<a class="sourceLine" id="cb4-11" title="11">      subY &lt;-<span class="st"> </span>Y[C <span class="op">==</span><span class="st"> </span>cc]</a>
<a class="sourceLine" id="cb4-12" title="12">      pcc <span class="op">*</span><span class="st"> </span><span class="kw">entr</span>(subY)</a>
<a class="sourceLine" id="cb4-13" title="13">   })</a>
<a class="sourceLine" id="cb4-14" title="14">   <span class="kw">sum</span>(tmp)</a>
<a class="sourceLine" id="cb4-15" title="15">}</a>
<a class="sourceLine" id="cb4-16" title="16"></a>
<a class="sourceLine" id="cb4-17" title="17">nmi &lt;-<span class="st"> </span><span class="cf">function</span>(u, a){</a>
<a class="sourceLine" id="cb4-18" title="18">   <span class="co"># u ... C ... cluster labels,</span></a>
<a class="sourceLine" id="cb4-19" title="19">   <span class="co"># a ... Y ... class labels</span></a>
<a class="sourceLine" id="cb4-20" title="20">   entr_Y &lt;-<span class="st"> </span><span class="kw">entr</span>(a) <span class="co"># entropy</span></a>
<a class="sourceLine" id="cb4-21" title="21">   ret &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(entr_Y <span class="op">-</span><span class="st"> </span><span class="kw">con_entr</span>(u, a)) <span class="op">/</span><span class="st"> </span>(entr_Y <span class="op">+</span><span class="st"> </span><span class="kw">entr</span>(u))</a>
<a class="sourceLine" id="cb4-22" title="22">   <span class="kw">return</span>(ret)</a>
<a class="sourceLine" id="cb4-23" title="23">}</a>
<a class="sourceLine" id="cb4-24" title="24"></a>
<a class="sourceLine" id="cb4-25" title="25">observed_activity &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;Walk&quot;</span>, nw), <span class="kw">rep</span>(<span class="st">&quot;Brush&quot;</span>, nb))</a>
<a class="sourceLine" id="cb4-26" title="26"></a>
<a class="sourceLine" id="cb4-27" title="27">all_nmi &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">30</span>, <span class="cf">function</span>(k){</a>
<a class="sourceLine" id="cb4-28" title="28">   myclus &lt;-<span class="st"> </span><span class="kw">cutree</span>(agn, <span class="dt">k =</span> k)</a>
<a class="sourceLine" id="cb4-29" title="29">   <span class="kw">nmi</span>(<span class="dt">u =</span> myclus, <span class="dt">a =</span> observed_activity)</a>
<a class="sourceLine" id="cb4-30" title="30">}) </a>
<a class="sourceLine" id="cb4-31" title="31">k_best &lt;-<span class="st"> </span><span class="kw">which.max</span>(all_nmi)</a>
<a class="sourceLine" id="cb4-32" title="32"><span class="kw">c</span>(k_best, <span class="kw">max</span>(all_nmi))</a></code></pre></div>
<pre><code>## [1] 8.0000000 0.5464722</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">myclus &lt;-<span class="st"> </span><span class="kw">cutree</span>(agn, <span class="dt">k =</span> k_best)</a>
<a class="sourceLine" id="cb6-2" title="2"><span class="kw">table</span>(observed_activity, myclus)</a></code></pre></div>
<pre><code>##                  myclus
## observed_activity   1   2   3   4   5   6   7   8
##             Brush  11   4   5   5   4   8   2 140
##             Walk  470   6  40   4   2   5   1   0</code></pre>
<p>The next figure depicts the dendrogram with colored branches as clustered with <code>k = 8</code>. The two horizontal bars at the bottom visualize the output of the <code>table</code> command. The upper bar gives the ground truth (whether a snippet is walking or brushing teeth) and the lower one summarizes the separation by the clustering. The first, third and eighth clusters are well separated clusters, meanwhile the other smaller clusters are rather mixed.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="co"># prepare plot: colors</span></a>
<a class="sourceLine" id="cb8-2" title="2">cols_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;#000000&quot;</span>, <span class="st">&quot;#C0C0C0&quot;</span>)</a>
<a class="sourceLine" id="cb8-3" title="3">col_gt_type &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;#000000&quot;</span>, <span class="kw">length</span>(observed_activity))</a>
<a class="sourceLine" id="cb8-4" title="4">col_gt_type[observed_activity <span class="op">==</span><span class="st"> &quot;Brush&quot;</span>] &lt;-<span class="st"> &quot;#C0C0C0&quot;</span></a>
<a class="sourceLine" id="cb8-5" title="5">cols_<span class="dv">8</span> &lt;-<span class="st"> </span>colorspace<span class="op">::</span><span class="kw">diverge_hsv</span>(<span class="dv">8</span>)</a>
<a class="sourceLine" id="cb8-6" title="6"></a>
<a class="sourceLine" id="cb8-7" title="7">dend &lt;-<span class="st"> </span><span class="kw">as.dendrogram</span>(agn)</a>
<a class="sourceLine" id="cb8-8" title="8"><span class="kw">labels_colors</span>(dend) &lt;-<span class="st"> </span>cols_<span class="dv">8</span>[<span class="kw">order.dendrogram</span>(dend)]</a>
<a class="sourceLine" id="cb8-9" title="9">dend &lt;-<span class="st"> </span><span class="kw">color_branches</span>(dend, <span class="dt">k =</span> <span class="dv">8</span>, <span class="dt">col =</span> cols_<span class="dv">8</span>[<span class="kw">unique</span>(myclus[agn<span class="op">$</span>order])])</a>
<a class="sourceLine" id="cb8-10" title="10"></a>
<a class="sourceLine" id="cb8-11" title="11"><span class="co"># plot</span></a>
<a class="sourceLine" id="cb8-12" title="12"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">5</span>, <span class="fl">4.5</span>, <span class="fl">.5</span>, <span class="fl">6.5</span>), <span class="dt">xpd=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb8-13" title="13"><span class="kw">plot</span>(dend, <span class="dt">leaflab =</span> <span class="st">&quot;none&quot;</span>)</a>
<a class="sourceLine" id="cb8-14" title="14"><span class="kw">axis</span>(<span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">labels=</span><span class="ot">FALSE</span>, <span class="dt">tick =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb8-15" title="15"></a>
<a class="sourceLine" id="cb8-16" title="16"><span class="co">## plot the bars</span></a>
<a class="sourceLine" id="cb8-17" title="17"><span class="kw">colored_bars</span>(<span class="kw">cbind</span>(cols_<span class="dv">8</span>[myclus], col_gt_type), dend, </a>
<a class="sourceLine" id="cb8-18" title="18">   <span class="dt">rowLabels =</span> <span class="kw">c</span>(<span class="st">&quot;k = 8  &quot;</span>, <span class="st">&quot;walk/ brush  &quot;</span>), <span class="dt">sort_by_labels_order =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb8-19" title="19"></a>
<a class="sourceLine" id="cb8-20" title="20"><span class="co">## legends</span></a>
<a class="sourceLine" id="cb8-21" title="21"><span class="kw">legend</span>(<span class="dt">x =</span> <span class="st">&quot;right&quot;</span>, <span class="dt">horiz =</span> F, <span class="dt">fill =</span> cols_<span class="dv">8</span>,<span class="dt">legend =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">8</span>,</a>
<a class="sourceLine" id="cb8-22" title="22">       <span class="dt">box.col =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">inset=</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.12</span>,<span class="dv">0</span>))</a>
<a class="sourceLine" id="cb8-23" title="23"><span class="kw">legend</span>(<span class="dt">x =</span> <span class="st">&quot;bottomright&quot;</span>, <span class="dt">horiz =</span> F, <span class="dt">fill =</span> cols_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb8-24" title="24">       <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;walk&quot;</span>, <span class="st">&quot;brush&quot;</span>), <span class="dt">box.col =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">inset=</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.18</span>,<span class="op">-</span><span class="fl">0.2</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Next we aggregate the clusters with <code>dba</code> to get representatives and plot them to get a deeper insight into the clusters. The precomputed results are in <code>data(&quot;vignette_ts_cluster&quot;)</code>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">   lprotos &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>, <span class="cf">function</span>(i){</a>
<a class="sourceLine" id="cb9-2" title="2">      subix  &lt;-<span class="st"> </span><span class="kw">which</span>(myclus <span class="op">==</span><span class="st"> </span>i)</a>
<a class="sourceLine" id="cb9-3" title="3">      sublot &lt;-<span class="st"> </span>lot<span class="op">$</span>data[subix]</a>
<a class="sourceLine" id="cb9-4" title="4">      subdm &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(dm<span class="op">$</span>dismat)[subix, subix]</a>
<a class="sourceLine" id="cb9-5" title="5">      m0  &lt;-<span class="st"> </span>sublot[[ <span class="kw">which.min</span>(<span class="kw">apply</span>(subdm, <span class="dv">1</span>, sum)) ]]</a>
<a class="sourceLine" id="cb9-6" title="6">      IncDTW<span class="op">::</span><span class="kw">dba</span>(<span class="dt">m0 =</span> m0, <span class="dt">lot =</span> sublot, <span class="dt">dist_method =</span> <span class="st">&quot;norm2&quot;</span>, <span class="dt">ws =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb9-7" title="7">   })</a>
<a class="sourceLine" id="cb9-8" title="8">   </a>
<a class="sourceLine" id="cb9-9" title="9">   protos &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>, <span class="cf">function</span>(i){</a>
<a class="sourceLine" id="cb9-10" title="10">      <span class="kw">cbind</span>(<span class="dt">i =</span> i, lprotos[[i]]<span class="op">$</span>m1)</a>
<a class="sourceLine" id="cb9-11" title="11">   })</a></code></pre></div>
<p>The next plot visualizes the aggregated prototype patterns for all 8 clusters. The first cluster is the biggest one and consists almost exclusively of walking snippets. The shown pattern is periodic and stable. The eighth cluster (brushing teeth cluster) also shows a stable periodic pattern, but with a much higher periodicity, which is reasonable since one’s hand moves faster up and down during brushing teeth than swings forth and back during walking, or even running. The mixed smaller clusters can be interpreted as hand gestures done during both activities.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">   <span class="co"># dfp ... data for plotting</span></a>
<a class="sourceLine" id="cb10-2" title="2">   dfp &lt;-<span class="st"> </span><span class="kw">as.data.table</span>(<span class="kw">do.call</span>(rbind, protos))</a>
<a class="sourceLine" id="cb10-3" title="3">   dfp &lt;-<span class="st"> </span><span class="kw">melt</span>(dfp, <span class="dt">id.vars =</span> <span class="st">&quot;i&quot;</span>)</a>
<a class="sourceLine" id="cb10-4" title="4">   dfp &lt;-<span class="st"> </span>dfp[, x<span class="op">:</span><span class="er">=</span><span class="st"> </span>dfp[, <span class="kw">list</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span>.N), by =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;i&quot;</span>, <span class="st">&quot;variable&quot;</span>)][, x]]</a>
<a class="sourceLine" id="cb10-5" title="5">   </a>
<a class="sourceLine" id="cb10-6" title="6">   <span class="kw">theme_set</span>(<span class="kw">theme_gray</span>(<span class="dt">base_size =</span> <span class="dv">9</span>))</a>
<a class="sourceLine" id="cb10-7" title="7">   <span class="kw">ggplot</span>(dfp) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> value, <span class="dt">group =</span> variable, <span class="dt">col =</span> variable)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-8" title="8"><span class="st">      </span><span class="kw">facet_wrap</span>(<span class="op">~</span>i, <span class="dt">ncol =</span> <span class="dv">4</span>, <span class="dt">nrow =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-9" title="9"><span class="st">      </span><span class="kw">ylab</span>((<span class="kw">bquote</span>(<span class="st">&#39;Acceleration (&#39;</span> <span class="op">~</span><span class="st"> </span>m<span class="op">/</span>s<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="st">&#39;)&#39;</span>)))<span class="op">+</span></a>
<a class="sourceLine" id="cb10-10" title="10"><span class="st">      </span><span class="kw">theme</span>(<span class="dt">text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Time (ms)&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Finally we plot exemplary accelerometer recordings for walking and brushing teeth colored according to the clustering of the snippets. First we define a function <code>plot_lot</code> to plot single trips of the list of tiem series.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">lot<span class="op">$</span>info<span class="op">$</span>clus &lt;-<span class="st"> </span>myclus</a>
<a class="sourceLine" id="cb11-2" title="2">lot<span class="op">$</span>info<span class="op">$</span>oa &lt;-<span class="st"> </span>observed_activity</a>
<a class="sourceLine" id="cb11-3" title="3"></a>
<a class="sourceLine" id="cb11-4" title="4">plot_lot &lt;-<span class="st"> </span><span class="cf">function</span>(lot, lid, <span class="dt">cols=</span><span class="ot">NULL</span>){</a>
<a class="sourceLine" id="cb11-5" title="5">   <span class="kw">require</span>(ggplot2)   </a>
<a class="sourceLine" id="cb11-6" title="6">   sub &lt;-<span class="st"> </span><span class="kw">subset</span>(lot<span class="op">$</span>info, lot_id <span class="op">==</span><span class="st"> </span>lid)</a>
<a class="sourceLine" id="cb11-7" title="7">   dfp &lt;-<span class="st"> </span>reshape2<span class="op">::</span><span class="kw">melt</span>(sub[, <span class="kw">c</span>(<span class="st">&quot;oa&quot;</span>,<span class="st">&quot;clus&quot;</span>,<span class="st">&quot;ibegin&quot;</span>, <span class="st">&quot;iend&quot;</span>, <span class="st">&quot;runid&quot;</span>)], </a>
<a class="sourceLine" id="cb11-8" title="8">                    <span class="dt">id.vars =</span> <span class="kw">c</span>(<span class="st">&quot;runid&quot;</span>, <span class="st">&quot;oa&quot;</span>, <span class="st">&quot;clus&quot;</span>))</a>
<a class="sourceLine" id="cb11-9" title="9">   dfp<span class="op">$</span>clus &lt;-<span class="st"> </span><span class="kw">as.factor</span>(dfp<span class="op">$</span>clus)</a>
<a class="sourceLine" id="cb11-10" title="10">   </a>
<a class="sourceLine" id="cb11-11" title="11">   d0 &lt;-<span class="st"> </span><span class="kw">lapply</span>(sub<span class="op">$</span>runid, <span class="cf">function</span>(i){</a>
<a class="sourceLine" id="cb11-12" title="12">      lot<span class="op">$</span>data[[i]]</a>
<a class="sourceLine" id="cb11-13" title="13">   })</a>
<a class="sourceLine" id="cb11-14" title="14">   d0 &lt;-<span class="st"> </span><span class="kw">do.call</span>(rbind, d0)</a>
<a class="sourceLine" id="cb11-15" title="15">   d0 &lt;-<span class="st"> </span>reshape2<span class="op">::</span><span class="kw">melt</span>(d0)</a>
<a class="sourceLine" id="cb11-16" title="16"></a>
<a class="sourceLine" id="cb11-17" title="17">   <span class="co"># assign the clustering to the snippets of the time series</span></a>
<a class="sourceLine" id="cb11-18" title="18">   d0<span class="op">$</span>clus &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb11-19" title="19">   <span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">unique</span>(dfp<span class="op">$</span>runid)){</a>
<a class="sourceLine" id="cb11-20" title="20">      <span class="co"># sub &lt;- subset(dfp, runid == i)</span></a>
<a class="sourceLine" id="cb11-21" title="21">      ibegin  &lt;-<span class="st"> </span>dfp[dfp<span class="op">$</span>runid <span class="op">==</span><span class="st"> </span>i <span class="op">&amp;</span><span class="st"> </span>dfp<span class="op">$</span>variable <span class="op">==</span><span class="st"> &quot;ibegin&quot;</span>, <span class="st">&quot;value&quot;</span>]</a>
<a class="sourceLine" id="cb11-22" title="22">      iend    &lt;-<span class="st"> </span>dfp[dfp<span class="op">$</span>runid <span class="op">==</span><span class="st"> </span>i <span class="op">&amp;</span><span class="st"> </span>dfp<span class="op">$</span>variable <span class="op">==</span><span class="st"> &quot;iend&quot;</span>, <span class="st">&quot;value&quot;</span>]</a>
<a class="sourceLine" id="cb11-23" title="23">      tmpclus &lt;-<span class="st"> </span><span class="kw">as.character</span>(dfp[dfp<span class="op">$</span>runid <span class="op">==</span><span class="st"> </span>i, <span class="st">&quot;clus&quot;</span>][<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb11-24" title="24">      d0[d0<span class="op">$</span>Var1 <span class="op">&gt;=</span><span class="st"> </span>ibegin <span class="op">&amp;</span><span class="st"> </span>d0<span class="op">$</span>Var1 <span class="op">&lt;=</span><span class="st"> </span>iend, <span class="st">&quot;clus&quot;</span>] &lt;-<span class="st"> </span>tmpclus</a>
<a class="sourceLine" id="cb11-25" title="25">   }</a>
<a class="sourceLine" id="cb11-26" title="26">   d0<span class="op">$</span>Cluster &lt;-<span class="st"> </span><span class="kw">as.factor</span>(d0<span class="op">$</span>clus)</a>
<a class="sourceLine" id="cb11-27" title="27">   </a>
<a class="sourceLine" id="cb11-28" title="28">   <span class="kw">theme_set</span>(<span class="kw">theme_gray</span>(<span class="dt">base_size =</span> <span class="dv">9</span>))</a>
<a class="sourceLine" id="cb11-29" title="29">   <span class="kw">ggplot</span>(d0) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-30" title="30"><span class="st">      </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Var1, <span class="dt">y =</span> value, <span class="dt">group =</span> Var2, <span class="dt">col =</span> Cluster)) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-31" title="31"><span class="st">      </span><span class="kw">facet_grid</span>(Var2<span class="op">~</span>.)<span class="op">+</span></a>
<a class="sourceLine" id="cb11-32" title="32"><span class="st">      </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb11-33" title="33"><span class="st">      </span><span class="co"># ylab(&quot;Acceleration (m/s^2)&quot;) +</span></a>
<a class="sourceLine" id="cb11-34" title="34"><span class="st">      </span><span class="kw">ylab</span>((<span class="kw">bquote</span>(<span class="st">&#39;Acceleration (&#39;</span> <span class="op">~</span><span class="st"> </span>m<span class="op">/</span>s<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="st">&#39;)&#39;</span>)))<span class="op">+</span></a>
<a class="sourceLine" id="cb11-35" title="35"><span class="st">      </span><span class="kw">xlab</span>(<span class="st">&quot;Time&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> cols)</a>
<a class="sourceLine" id="cb11-36" title="36">}</a></code></pre></div>
<p>Now we can actually plot the recordings. For the walking record most subsequences belong to cluster 1, and for the brushing teeth record cluster 8 dominates.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">   cols_8named &lt;-<span class="st"> </span>cols_<span class="dv">8</span></a>
<a class="sourceLine" id="cb12-2" title="2">   <span class="kw">names</span>(cols_8named) &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">8</span></a>
<a class="sourceLine" id="cb12-3" title="3">   gg1 &lt;-<span class="st"> </span><span class="kw">plot_lot</span>(lot, <span class="dv">1</span>, <span class="dt">cols =</span> cols_8named)</a>
<a class="sourceLine" id="cb12-4" title="4">   gg2 &lt;-<span class="st"> </span><span class="kw">plot_lot</span>(lot, <span class="dv">106</span>, <span class="dt">cols =</span> cols_8named)</a>
<a class="sourceLine" id="cb12-5" title="5">   gridExtra<span class="op">::</span><span class="kw">grid.arrange</span>(gg1, gg2, <span class="dt">layout_matrix =</span> <span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)))</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>To check the convergence behavior of the DBA algorithm next we plot the iterations and the distances. The lower three plots are the dimensions of the iterations 1 to 20 (plotted with <code>plot(x, type = &quot;bary&quot;)</code>, where <code>x</code> is the result of the function <code>dba</code>). The upper left plot shows the iteration-to-iteration distance of one iteration barycenter to the former <code>plot(x, type = &quot;m2m&quot;)</code>. And the upper right plot shows per iteration the average distance of the barycenter to the list of time series and the the standard deviation as the width of the grey shaded tube <code>plot(x, type = &quot;m2lot&quot;)</code>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">   <span class="kw">theme_set</span>(<span class="kw">theme_gray</span>(<span class="dt">base_size =</span> <span class="dv">9</span>))</a>
<a class="sourceLine" id="cb13-2" title="2">   gg1 &lt;-<span class="st"> </span><span class="kw">plot</span>(lprotos[[<span class="dv">1</span>]], <span class="dt">type =</span> <span class="st">&quot;m2m&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="st">      </span><span class="kw">ylab</span>(<span class="kw">bquote</span>(<span class="st">&#39;Dist. of&#39;</span> <span class="op">~</span>m[n]<span class="op">~</span>to<span class="op">~</span>m[n<span class="dv">-1</span>]))</a>
<a class="sourceLine" id="cb13-4" title="4">   gg2 &lt;-<span class="st"> </span><span class="kw">plot</span>(lprotos[[<span class="dv">1</span>]], <span class="dt">type =</span> <span class="st">&quot;m2lot&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb13-5" title="5"><span class="st">      </span><span class="kw">ylab</span>(<span class="st">&quot;Average norm.</span><span class="ch">\n</span><span class="st">dist of itereations</span><span class="ch">\n</span><span class="st">to lot&quot;</span>)</a>
<a class="sourceLine" id="cb13-6" title="6">   gg3 &lt;-<span class="st"> </span><span class="kw">plot</span>(lprotos[[<span class="dv">1</span>]], <span class="dt">type =</span> <span class="st">&quot;bary&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-7" title="7"><span class="st">      </span><span class="kw">labs</span>(<span class="dt">col=</span><span class="st">&quot;Iterations&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Time&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Accelerometer&quot;</span>)</a>
<a class="sourceLine" id="cb13-8" title="8">   </a>
<a class="sourceLine" id="cb13-9" title="9">   lay &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb13-10" title="10">                <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb13-11" title="11">   gridExtra<span class="op">::</span><span class="kw">grid.arrange</span>(<span class="dt">grobs =</span> <span class="kw">list</span>(gg1, gg2, gg3), <span class="dt">layout_matrix =</span> lay)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>    <!-- ========================================================================================== --> <!-- ========================================================================================== --></p>
</div>
<div id="clustering-time-series-of-different-lengths" class="section level2">
<h2>Clustering time series of different lengths</h2>
<!-- ========================================================================================== -->
<!-- ========================================================================================== -->
<p>The data set <code>drinking_glass</code> consists of accelerometer records of people moving their hands to drink a glass. We use these time series to demonstrate the clustering of time series of different lengths, contrary to the task of clustering the signals of walking and brushing teeth where we cut the time series into snippets of equal lengths. The motivation for these two different approaches is that the walking and brushing teeth actions are of high periodicity, meanwhile signals of drinking a glass are records of a single drinking action. This becomes clear later, when we compare the prototypes in Fig.~ and those of drinking in Fig.~.</p>
<p>First we load the data and have a look at the average length of the time series. The set consists of 100 time series with lengths between 255 and 1322 recordings, so about 8 to 41 seconds.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">data</span>(<span class="st">&quot;drink_glass&quot;</span>)</a>
<a class="sourceLine" id="cb14-2" title="2">lot &lt;-<span class="st"> </span>drink_glass <span class="co">#list of time series</span></a>
<a class="sourceLine" id="cb14-3" title="3"><span class="kw">length</span>(lot)</a></code></pre></div>
<pre><code>## [1] 100</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="kw">summary</span>(<span class="kw">sapply</span>(lot, nrow))</a></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   255.0   303.2   376.0   427.9   471.5  1322.0</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="kw">summary</span>(<span class="kw">sapply</span>(lot, nrow)<span class="op">/</span><span class="dv">32</span>)</a></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   7.969   9.477  11.750  13.373  14.734  41.312</code></pre>
<p>Unlike the previous section, here we cannot evaluate the clustering via NMI, since we cluster time series all of the same class. So for this task our intention is to learn prototypical patterns of one and the same activity. We proceed as follows:</p>
<ul>
<li><p>We calculate the distance matrix and cluster the time series. Since the time series are of different lengths, it is important to set the parameter <code>normalize = TRUE</code>.</p></li>
<li><p>Then we plot the dendrogram and cut it at a reasonable height to get clusters of representative size.</p></li>
<li><p>Finally we aggregate the clusters with <code>dba()</code> and plot the cluster representatives.</p></li>
</ul>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">dm &lt;-<span class="st"> </span><span class="kw">dtw_dismat</span>(<span class="dt">lot =</span> lot, <span class="dt">dist_method =</span> <span class="st">&quot;norm2&quot;</span>)</a>
<a class="sourceLine" id="cb20-2" title="2">agn_uel &lt;-<span class="st"> </span>fastcluster<span class="op">::</span><span class="kw">hclust</span>(dm<span class="op">$</span>dismat, <span class="dt">method =</span> <span class="st">&quot;complete&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1">hh &lt;-<span class="st"> </span><span class="kw">sort</span>(agn_uel<span class="op">$</span>height, <span class="dt">decreasing =</span> <span class="ot">TRUE</span>)[<span class="dv">6</span>]</a>
<a class="sourceLine" id="cb21-2" title="2">myclus &lt;-<span class="st"> </span><span class="kw">cutree</span>(agn_uel, <span class="dt">h =</span> hh)</a>
<a class="sourceLine" id="cb21-3" title="3"><span class="kw">table</span>(myclus)</a></code></pre></div>
<pre><code>## myclus
##  1  2  3  4  5  6 
## 27 20  5  4 34 10</code></pre>
<p>Dendrogram of the clustering of drinking a glass. We cut at the horizontal red line and skip small clusters:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw">plot</span>(agn_uel, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb23-2" title="2"><span class="kw">abline</span>(<span class="dt">h =</span> hh, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAHgCAMAAABNUi8GAAACx1BMVEUAAAAAAAMAAA0AABQAABcAAB0AACAAACEAACgAACoAADEAADIAADQAADoAAEkAAFgAAGYACAAADQAADVEAEAAAFGYAFwAAF2YAIHsAISAAIXwAJDoAKAAAKDoAKJAAKhcAKjoAKpAAKpwAMVEAMZAAMjoAMpAAOh0AOigAOioAOjoAOmYAOnwAOpAAOpwAOp0ASUkASbYAWGYAWLYAZoEAZpAAZp0AZrYEAAAKAAAKUbwLLSoNAAANFzoNIHsNUbwXAAAXKJAXZtsdkNsgADogIQAgWGYge9shIAAiISAoAAAoADooOgAoOpAogf8okNsqAAAqFwAxAAAxAA0xUTIxZmYxe3wxe9sxkNsyAAAyAA0yUTEykNs6AAA6ABc6ACE6ADo6AGY6KAA6OgA6OmY6OpA6Zlg6ZmY6ZpA6ZrY6e3w6fHs6kJA6kJw6kJ06kLY6kLw6kNs6nP86nf9JAABJSQBJtv9RDQBRMQBRvP9YAABYZipYZjpYnJBYtv9mAABmADpmAGZmFwBmOgBmOjpmWABmgWZmkJBmkLZmkNtmnWZmnZBmtpxmtrZmtttmtv9m2/9pEwBqRQ17IAB7OgB7fCp7fDp72/98IQB8ezqBKACBZgCB//+QJACQKACQMQCQOgCQOjqQZgCQZjqQkGaQkLaQnGaQnWaQtpCQttuQtv+QvJCQ27aQ29uQ2/+cOgCcWACcZgCc//+dkDqd25Cd2/+d//+hLQO2SQC2WAC2ZgC2Zjq2ZpC2kDq2kGa2tli2tma225C227a229u22/+2/7a2/9u2//+8UQ282/+8///bZhfbeyDbfCHbkCjbkCrbkDLbkDrbkGbbtmbbtpDb25Db27bb29vb2//b/7bb/9vb////AAD/gR3/gSj/nTr/tkn/tlj/tmb/22b/25D/27b//4H//5z//53//7b//7z//9v///8wGBPdAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAgAElEQVR4nO2djb8syVnXy3DFG3XuHkE3EteX+ILLXg4xuDKo0b3IS/Qa2BV8IcbRlQWWEEUO7Ea9XDMhSyIa704UDYkIHCAiaDgIaNRZXxLdcCJJ2B2SjeDRsAxns4yn/wjrrburqqu6q/ptqvr8fp/duWemq6uqu7/9VNVTbySDoIhF9p0BCKoTAIWiFgCFohYAhaIWAIWiFgCFohYAhaIWAIWiFgCFohYAhaIWAIWiFgCFohYAhaIWAIWiFgCFohYAhaIWAIWiFgCFohYAhaIWAIWiFgCFohYAhaIWAIWiFgCFohYAhaIWAIWiFgCFohYAhaIWAIWiFgCFohYAhaIWAIWiFgAVuvj4I4SQr3+a/XlMDs/cAf/zqTuWDeGafdPTzSmuyUFNTJAUAOXaPSHQIkcNgL7wRB1WElCK6KoxSQDqJQDKRJnMtaoHtB6rAlAyO2lKE4B6CYAyUbCu/zg1j5TTwzMBqOBnt2Q2NfuFR2S5vWbw0QMXT9Ef3nDGT5392BPk4GkZD4fuk9Qez+m/WqifoF+uc2wvnlrQ5HgC5dmf+C5C7vvus0yedv1EP/4JZuK//oTnaP6JR8jsyewXFjK+SQuAZtyACmt28UNv+MWsCqg0jPQHCSj9men6aX5MmlwJKDuN/lIJJQxrYa45gPJsGYDFI47PHlGPb4vTZaSEPCKjmLgAaCasUvmtAig7fJZ9nFdQxc9rZtTOFxLew6ez/yVOzQEVf+ihrj/NPunfFLb5GbOSAkB+Ng0lKC2Or9XjNEt/5ExExQA9YpkhT8rw0xYApRIQ5aoASg9f/x/yIP9ZFvwbiVDZIFIAnZ1UQ9GI5lkZs3K2rJCuJdeV41Sf/K+PsIpDYZwPz4x8T1MANGsEVJS5ooLIf6bhiyJ3o7aHNECrobilprFxc53XMU+y0nHAvuZ/q8ezix8RUc2ltRefAPSSyF3ECwReEE6o2b+W2GyJD6DVUDydPDEVwPw3esrKdpy9Itf/5SeXAPRySmkk0aZ6FVCK6HsfEU2Y3IIWxboVUB5hNVRuQSsWssmCimzsAOhllcXNJNDYls2Qix8uKoiqxbUByuKZW0KJX/Q6pjjbXQflx7d5FfYIgF5KWRz1vIXMSDtiePytM1bOF9yumR/yhWX5g5TuqK+EEljprXRxtrsVn1vQwzMVewB6yVR0db4hL2+LJg5F4KkSuq3qB2U/2AHlXZ2VUNKmrlU/qDzb6Qct6qBoJF1qycEizJskK4HnlNlv+u/CVaSMJHmKezRf+BHKLx8SYgM0HyxihpKAXvyXBbnvSa2VLnuS/oHIC03jG56utOKv//hGvBsAFIpA67oxVZdHADQ6rXlFQzj1IQAanXL/afOAqMsgABqfXviuheeg50sgAApFLQAKRS0ACkUtAApFLQAKRS0ACkUtAApFLQAKRS0ACkUtAApFLQAKRS0ACkUtAApFLQAKRS0ACkUtAApFLQAKRa02gJ4vmtcPhqBeFAJosTTlpViYEopCQRZ0K6Zhw4JCoymsiN8t+ZIGABQaS6F10PXsBIBC4ym4kbQhRwAUGk3hrfjzxX0AFBpLLdxMF8cEgEIjCY56KGq1BHQDPyg0ivqxoKUDv5foIChXz0QBUKhfAVAoagFQKGoBUChq9TyaCYBC/SqIqIvjJu8SAIX6VRhRF8cNC/sDUKhfBRK1bejlBKBQv0IjCYpaABSKWnsClCSlfu8RFKJ9AdpvssMqqcxOTQC0WUlldmoCoM1KKrNTEwBtVlKZnZoAaLOSyuzUBECblVRmpyYA2qykMjs1AdBmJZXZqQmANiupzE5NALRZSWV2akoZ0H33gPauPm7K1JQ0oH1EEpGmdj29CIDGo6ldTy8CoPFoatfTiwBoPJra9fQiABqPpnY9vQiAxqOpXU8vAqDxaGrX04sAaDya2vX0IgAaj6Z2Pb0IgMajqV1PLwKg8Whq19OLAGg8mtr19CIAGo+mdj29KOymbAgRizO5NlEAoB00tevpRUE3ZTM7yXZLtsAdAB1AU7ueXhRyUy6Oj/jn4VkLQAcYCDm1Bzq16+lFITdltxRrL64Pz1oA2lMmup8WraZ2Pb0o3IJSrecAdABN7Xp6UVgdVGK5W4avUQ9AGzW16+lFoa14Ucg7F6sHoB00tevpRaP5QQFoo6Z2Pb0IgMajqV1PL2p5U9BIGkBTu55e1M9N8fBoAtBGTe16ehGK+Hg0tevpRQA0Hk3tenoRAG2XdDLa3z3qRwA0taTDlExGXQrriy9fzEveik/muSeTUZeCLqDLbscAdC9KJqMuhV1Ah92OAehelExGXQq8gPa7HQPQvSiZjLqERlJqSYcpmYy6BEBTSzpMyWTUJQCaWtJhSiajLgHQ1JIOUzIZdQmAppZ0mJLJqEsANLWkw5RMRl0CoKklHaZkMuoSAE0t6TAlk1GXAGhqSYcpmYy6BEBTSzpMyWTUJQCaWtJhSiajLgHQ1JIOUzIZdQmAppZ0mJLJqEsANLWkw5RMRl0CoKklHaZkMuoSAE0t6TAlk1GXAGhqSYcpmYy6BEBTSzpMyWTUJQCaWtJhSiajLgHQ1JIOUzIZdQmARpv0/lYjqWqEy3XdhbGiA6AxpuGp6dxpAJpWGp6azp0GoGml4anp3GkAmlYanprOnQagaaXhqWTu9MWxaNQ51xADoGml4alU7vSGyK3mtvkf/tEB0BjT8FQid7rYCpGiengWGB0AjTENTyVyp/PNZKm2WMB2Eml4KpE7DQs6atIANDjpfKtO1EEBaJxJ56vUO+xnlv0fpuB/if13mlDHf1vmB/8a/5L+4/VFLmI/aPesDffiw4ImmjQATSsNT6UH6BibyQLQaJQeoGYszQMHAWiMaXgqeUA9ogOgMabhKQAaeoafAGhPAqChZ/gJgPYkABp6hp8AaE9KBNCRN5MFoNEoEUBH3kwWgEajVAAddzNZABqNkgF01M1kAWg0SgfQ9tEB0BjT8BQADT3DTwDUJ5m4Fx8BoJHFPG4a/SUDQFuocwx7NSQAdIB4pwbo+EkOEtUIyQDQFgKg4yUDQFsIgI6XDABtIQA6XjIAtIUA6HjJANAWAqDjJQNAWwiAjpcMAG2hBAEdt5uGpxhVNEPHC0AHSRGADh8dAO1wPgAdPjoA2uF8ADp8dAC0w/kAdPjoAGiH8wHo8NEB0A7nA9Dho5sOoIOO6gWgw8Z7KQDtOT6PEAB0+OgAqNepAHTYeAFoeHweIQDo8NEBUK9TAeiw8e4P0EEmDQHQsaMZOt49AtpzOHdgADpgNEPHC0A7Jg5AO8W7JmTON5R1LYADQDsmDkC7xMv2l1uTOVuIcYSNvCIAtO8YAOig8fKtELezk2ycrRABaB9JtkxxX9G449295YT/69omNpObyYrjvW0mW9O8BqB9JNkyxX1F4443B9S1A1I2jAUl7gAAtI8kW6a4r2hc8a5LQ+aoXTIVdVBl32NrdP5HAKhPCABaWtBatWvF1znJAahPCAA6aHSk5igA9QkBQDNWbAsr17RPgmd0th8BaMsQAJRqHUJm0GayANT/VCNE+2EEPeZpzGjc8Tp9716x1N5DAOp/qgloTwn7p7jnaNzxcidnf9FZfwSgoSEAaBFv4xZIYdFZfwSgoSEAaBnv+aLZhDY2pABox1MBqDVej104mTa5F3/rcudPBNDd0tFTFpJS2Kn2YdUANCRepf8oqKszRUAfXTjbjAMBav2WAKBdZiz4RB8QVmlHBQ0WSRHQI1pcOCrlALTu/MEAVUp5V130MllQdqVbYmUUgNadP5wFFfXKLVm5PaKbnN3p10GLyna1Tg5A684fDNDczURto8s8lmbWGWBqgHZJKexUANoQfV7BpLXLmjHL3tFZfwSgvocAaCW+vILJLOgEAe04Qb59vnxPBaBN0Rd10C59SvECGnpC65RangpAG6PnFUxqPIOGNbmjs/yYEKB5n5nFowFA684fENDBoksQ0POHT8SYQsvbCkDrzgegISnXHa47QVbI1/RzXanvANC68wFoSMp1h+tOkC4N5m+rujQAaN35wwC6Wx4VPUnpTPmwtMydLfR2FnRumzuQHqA1N6pJHpHXfu2slC2oO0BXQLMNm/3PKqK75QSK+PY5BqCRAsr6OMnMyicArQ0yIKC0kD88W3eYmZQ1ZS8hQFsl2+VUANoU/XZ2QhsFnebOAVBbcL/qHQBtiJ61C1irtUM/ZwZAA4ID0LAcMM+K3a3SKjrfowDU+rW+Lh+qSQCaW9B1zWycgOh8jwJQ61cAWo1P1EE3zvH0gdF5Hh0f0Da+vrB8+QWPHFDvOzRqK567VnqKzu+oFVDPm9MSUP9oQpMNCh47oL7njwfo8NF5A+oXIwDtmAXfcwCocRCAAlA9Ps+FG3yjCzgKQK1fzZPa15jrsuB7zv4B5epj+TAA6h08DNC2qfdyzqUA1GECAKj1KwC1xDcwoPYgANT6FYBa4rt0gLb0hgLQusinCqgGyViA+kXmn2xQcAAamg8PQNkUsvNFjTtfy57mG2gCtPLFGtydWMMRANrhnGQA5Xyy+Y7OoHr2Lo5LnxUArf/dvC26LQCgmQegfKyomOXoubqdsgYEAK3/3bgthi247ID6OerZvZLTyXzXB90WY08AaP3vxm0xbMFlB9RTfJZjiAW1HUkRUOeoeI/Gvy2E5WwTUN0W1AJakztPNWQ7GUB3y4NTZcvjoOjSBrTFkboQlgvVrllQs/G0oJ2ZqMli86sYE6BisiOxLzzcEB0AtfzmApRXulRbsD9AG1OJC9D20QFQy29uQAvbNTeOAtCBogOglt9qAbVHAkC95LWZ7HQc9Zcd0LqKaJyAmrHYL2Ayjvo9ALohcnHSTXMrvjEP7bNI9ACpAuqKbiqO+vEB3cyIXHcHgA4ZXYOjvrS6AFQ7TBvwhL3f+UoaQwHqdoamCWi7zWT1I/bKFgDVDu+WK/7DWm5pMRigzliSBLTlZrL6EQDqbUEz1nkHQL3VditE/QgA9QCUFuzih92SJAJoY+dp5xw2qu1msvqRQQF19jGnBmix7aTwhKQAaE9ZckTvowQsKHF9ixpQ84XSboYRid1gtTVd0wK07Way+hEAWgXU9nMToG3z4wo+BUBbbiarH9kroJqZ2TOgho/N/BeA9hyTb3QBgDYUXG0ArX7JwoeUeR2pC9F03ZXzAOh40YUAWh9tb4DWxVj7OwC9NIBagwDQaiSjAGrWPgCoPQgArUYyDqBGLgCoPYjrvrg9KwC0MT+u4ADUEqQtoPUR2r4B0KbgANQSJFFAPV3k7sMA1FsAtA2gHmHMXwBoOwHQfQBa/tIdUFefp1e/JwCtD9IDoPqTaA9o7VMdGdC6yJvuTX2aNSHqnksIoO0HBjTlsA/tAdCagEGAOtJqSr/mxwEArXaPxgdoSPrNGhdQ89UCoKGAVs7pB9CG53J5ALX9O3lA/ZryrngdWe0ZUFcyRkRmjKRq0tMDVFnpMiZAjVs7JKD2MAkB6oxRvZ/VIGkAqq506QOoYmoUkIhrJbj2gFo+HJfQBKijXQBAG9Nv1uCAaqve2gAtVyi4WlpZ/wv3AdQsh3oHtCZr2m/tADXL0T0BansJJwGostKl5SI2lMnd8h5Cjj42e39hZXsG1AiYGqDOTNec1HDInsV6QC3RTgBQbdXb6kUIdtefdXi2fgmbHSbDTBFQ0/wAUB8ND6i66m31IvhMUfqxPnzuaxig0spOElAjAAD10fCAqqveOiwoq6eu58/2bEHdNbdJA2rt83T16vQIqPNoN40BaPWwEowvnEE/xAoFFNX+AHV9TBzQukhcvwJQ/bAajM9lpk0ltkIBW2ssbkCtJikA0DUtSfgKVysjWVfSrkw7TwKgHaITF14/jiByQG2Z8AeU1WDWrLKjFxVFwDUvSoyt/PYDqPIqKQeN13OagNYHHBRQj8NDAsrXBBPbItjWZuHbd/3qja9YHGmbqnUCtL4u6gZUfZWUg9YTLi2gWpTDAap8dbQo+gKUu3nFula21a3E9l3kiFZ7Pk/htxug7sNmn52aY8urlA6g5wvnnompA2qJxhKsJj/dLCjv1LjBLNanlL1+BgPUiFzNseVVih9Qjw0TgwFV4xQRTxnQsuBUFmJTTmCdGs/wda8ov9v8LrsBtVn8PgCV+aOvEuuIfgV7lTYHtjsUF6D5mmG9WlC+vGBlt4UkATVxsT3MStNDS4Z1ary4eMDYyq8GUEt++wGUW/g1uZd5V26IpfITAJTaO1Yw9VvE840WzN0W2gBq5WNUQB05dj/MajK2rfz2Aih/lf7f32avklwqPwVAabbpq90ToLvlN9OItqK+YOy20ApQ2wmpAer+eWxAmXJnAl8qPw1A2Tr1nQFVK56z9xs71UcHqLXY9gHUeth5h9w9kvsDtKgps6XywwCt72L1V/j554v7OlvQLZEW9I5Ac2M6VaIC1H6kd0DZx5qcZucP0df23yxKb31rQCuVHouX3QkoH2j+OpkL1hEdCKgla23U4nxax+9cxO/I4RkD9B2CddUpuCdAXWmNCuiaUnD+EPfWf3tZsLQHtP5fE1ANZjkRYkOEDaHNWCegFxL7VWaZdboHQDtEp9zk9ex9ARZULy3sqaQPKO//ZI76bM0d9fK2jAaockybCFHvqD9/mIgxP5Rpt7loq5bne20m6zgsPzbkRt5eLXrT9DDVc2pTSRFQfewI845fHN9g3vpvFINjTT9oKd4QaAOoYeScgCoTIWod9XJLpzUHOhpAzVhCqsR5/lll9iar4uhbMlwmQIWzsRw7wp7w5h42BcFhQR1bSAcBavmwXKicCJHvLbiy3wdSzIVkeVVHm8cFaFB0Rf7tldlBAOUA8Gd78AHh1+oN0OZqlwGoKC+Ye+2uJ47OF2+XPZ/sMM3hKTWhB6e/Ql5Teut1stXekgEBFRMh3vjwyXb2nkrxrdoiaWc50BMDtOHwVrQg+wP0GfK1Wfbz5M1l80Pf87oloDVhtO8aoM8QxRCWU120wUfzTD9RSuktGRBQtc/AWnwXAdm0Rz6xfLfcexHfYTNZI0x9QFo1Ozr/hrPSQeoNqPJyq+cwKHbLm+zjdll4ihmlxZ7XIwK6W76dGsKL73n5c5oFtV9a5UjRWzIooFnxIluLb51keSf3DGiXzWSNMLUB16xq5hjq5a7tmjfHBPR8cZN9vL1ofojCqdzzekRAKV7MEH5k9u8Wj8uxI25Aq8p7SyoEGn7P+qzaAM1dRuJ+aMX3qfNE41L3BminrRDVMJUhTLpJ5u8tX4zE0oJ0X3gToBULqnXkjW1BV8wQvutuQl6lzgDxfR6yt8RBYntANznc0gSpxbfjaquXqj4D35azUyEnd9pMVgtDn8lppo1h0tPhlu0XM6sFdaZUD2j5MhwVKagdeT6AKvbJ5qxxPRMjqyIv7Hn/PHmg7DYOAlQ2MPsGlBtyzU/wgbL4tkXBZS6+5XgG7bQXC8pKknmmjWHSVHhZLdMN2gHK46J3kH78xtKvlacj97xuBtT2vfmZVLPK80Kz8Ual2zgMUD3mvgAVLiNuOBwmyHJiZfGtvQHaaTNZI4xoPW8dnaYb4WCxDXHyB9RD+p7XfQFKa5cNgBbi49kUN2Nz1ksnFc3yIBZUGA6HCaqeWF18a3+AdtlM1ggTmOmBALVGYUbQAtBHq10PVnHDo/YSegKaV6H7BjSvg27J2x0myAaoufjWHgHtJboeALU25OsAVezOBxfarF7hVVSjMCNoAegR2Shjju3XSpm8+MFXs7wobkY/QAvvT++AZjtSb4IsJ1YW30od0NbxGh98aBqnbWutoKsSduduc5wQn4b+anNgWx+A8reBPTVXO1bMMP62TPoVCkd9052QTir2Z26wjAZbJ0BbmJjK4lsAlH/woWkPv42Qb1l+yZmtgq6qcDNp44QEJK9hBZs6sK0fQDPOaGUOoJKhbH03nx93d9lL6L6BeR+J0JvYT851rMYFtLL4VpKAmp2KbeLVPsTQtHuYS/8ln3tmK15USUe9Pk5ol09Dz7KP6NOAegK0NkMsL69npvuXr7yz6CV03kBeW/0weZB1spW+MnuuDA+Y2yOmRJ97Va0jpk25sUsW0EqnYpt4DUDl0LTs/K+a6za6LOjj+jihXTkNfcvWhSq7C4YHVNbcmO2h71fRS+i6gbwIvTh+La+t0qYqPYd5UkJyZfmxOjbKPmLaFDubWZw7y7ITruletdU4gFY7FdvEq3+wZoWYQ/6sjwVlj+B+Wlv6tcUXH55t2Wxa8Vi+I5+GriSmVxuDAdVy4HpEas2tDOi6gXIZVVFbPbVMQWgJqDE2yjFi2hRhFod79B9dHE0C0Gqnok1aNevgQ5Xmtf7Bh6a9+65T8YS18q7MRd7JIcSbU0yvFEXmM9RmrskfM6ahuxFrQKHhbFPGDGMvC5p3ilemILQFVB8b5RgxbSp3mL64ePnZhlybAKDVTkWLymoWvzfkBn09tXgrV18+4cKlr98Rzudf+zJavbglnI2ZKO035G4xCuIbdUhscbQBVKlxez8iJ6Dr2UMrMXvto+TbREVJ6yjpBqg+Nso+YloZtSwjE23S3fK11OJcNVfpSRDQaqdiVVo1K8v46M3Cm+i+6bYM5Ae0pvLXynj5j6zIn+fjyMwMdQZUlH+W9TjqVL2maqf4+2wdJV0BVcdGWUdMq90JMjJhQemtFBZHX6UnRUArnYpVmdWs56ktLb2JWfXDB1DeCuKdqlfyeDmg7G3YctO5u3XXadF1aImjenWNgIqnp6zHUcw8epVz1RurmKGk2T1fPK7NXgvLVTOg2tgo1ZklrEM+5q7o0eTv4IEA1LA4tuIkDUCbZVaz+Ph3Jt2bmH8U3nBy7WeVp24U8TSyZ1VnYw5oOY7s0zdfaYy+6wxo7pPN1+MQK4bde3i2e0xbcLNZtIL4S8vV+eLrtNlr3rkyDzuvThkbVb1ubdRyYSeZxWFXolucKQMqmFGqWTesUz01QDefw2edvap86mUY4QehTeV//BnvzLa/4ctyP5cMWQwDJ0fqI9DjsF6dpwXN8vU4xJqLv+nv0GQ/8pnfmzktoVXr2dvm54vbc6MFqZLaA6C1qhu13KRUANWG4Di11apZv2Q3NCqguyUzLVvpqD9TD+ee123RgC/HNFaydq4vH9EV0KJbSKzHIZbavPYYTeNTV/9F5rSEdm3IjdlDT4rZa/+kbEF6NZLMw86r27qd8lntqOUmJQWoXo52SkECyvuGsu1VfQ65Nl6/0fOqDb7ox4JqNe6OFpRVEH+3rBEqLUg/N5N52KbK9C+LtsQctZyPKKxdTbKalxYaD1B6Bxrn3PmmUG9BLwgbA1LreS1N+rXH8uaAfTH26tV5AKrzUdRBL97qXLu2RqyC2M5Rbx62qDr9yy5jGKocUajO67eelhKgtCbFrmnLvRJhj6iSQmEn7+V36AvKpy4OH89Lz+v9t9gCepYMFSY9H99+ZCThuDorltUMKl/btuJLtXPUm4erskz/cgXUykDhTP6isiescXxzW41pQZm5291yVPWDUpA3nYL1NhrPt1Za8VuyUjyvV2+q74O5kLlyaysz8a1XFw5oy7vMO3nkeFWzBdm+DspUeN7ZzZidaNO/LFqzXuIvp+G/KpMBhcV8nhU97j0hqnlpobEAzXsidss/7Z7w4rMMvgpobVY24vZXY2OOkUrTSK2KxQPoo2xDGtGhprcgHY56Zwb0HAjPO43ntbM/k9eGapxfoiB/pZi3LW5YMeuQZuvKO7PkLWgm0HsNe/VrJrxkdY78ajLNec9ZLBz+8te52TTSqmK9A6r0fH6gtr2sS5SjfFca++RCdfWGAEDlDtN3/xWK3R+mppl7ON0VDx78efrwlCnbEueiDuqqVycEaFa0bd0TXphcMz0tyXjkXbKYiXRzM7old4qpv7LnU62KhQOqdlZbGkmi55Ma6T8/+8r69rImpVN2q48XsKwgFgBo2eLKRyrW2gQe/Hme1h/KjWd+U5ta8d01JqBZ45w7ppp32UjGmRi/bW+lCT3J7t1N+9ugNo30mfjBr32ls1rLquz5fOtn/1z2k3XFoSWHEgX+aqnjVS0riIVa0N2StbieNVtcFuWDAsthqGNqVEB7TsaVmCh4Xibb95+++UBzhNpM/FBAq53VWlbzkT+PH559jAPq66jXbFXlmLGCWEgdVLS4xEB+j67XxoJ8SE0AULMpxG+jGI2jekjrpc7EL55wXnJrvf1VVTurtayqI3/u+vdZNUPKyhxGvDqg+oUaK4iFACpaXO+hba65V4kVVpC7LqedRgS0qFKVa3R2SyZPzGhYyTrTm4w+psDYiVwrjdH0H5kldhuaame1Hpno+dwcfEiM/DEjUlfmqM+YfqH6CmL1gHacEhYShf/leGlsQKtrdPYgvWHVyoKqkk9YOsfNviqLKp3VRmSidbiZ/QRfU8awQ2LQ6v3N20xWLlRbQawWUHWAqtPB9zsbO+TroshLm9/8GHOYvoqfEnrjbQoDtPEtagK0ukZnQJIfdG5/oz90vQ7qV3FSyyX5hGVj1+ztt6dfMxylQXJlDmYdm229fqGuJarNRr42QJUlUd7UqzzjtAz/m8s/8dVHbqPRNKtMKW1+rzITsfnymxQEaPPczCZAK2t0+iT56Zs+1kWR3or3MdRauRRsQbupWA1+3lsKtkoPcySU95Fce+weQo4+Nnu/aL7Re/YaYxdwTQ1jG5R7RX7bmT5hpJtCAPWYm9m3BRVJ/gp5+VmtBe0qfdOVsg66UuqggzVh8/md25BmRUNZZqn0sBdwPf8P5Espiw8ykH7L4dn6JWJoOK1xsQUs9F3AjQhrZ5Uppc2vp0bk4gfyyYydFQKox9zMekDL99ftP7EmuXvss39uWEDVTVeKSlye45f9b7clFv33vLVSs0VkvWw7yNarsSwzKj0Hp/z62AU9SO8mG+F96xU/dfjc1xSTa3bLvzxWDYcAAAwNSURBVJRl2i7gRorl2Ia76IMwxvZqpc3Hgy+nRuEWNKubm9kQnWWNTs8k//nVdw0IqLYAlne5xGtuRFcf1a5mBa8zsJEj9l5cXDk84/Ztt7zrdD0XjvrPMTuInFFoF6rWWAcrbcLqoI1zM3v3gxZJ3uIvbmPwlu6UyjIKHuL991fYe/YR8hc7WdBgmWWZz4wFZcTeh9nA/g/Pflo8R3ryhpmNo2aXaDGL76Y2wltkqbm0aaPQVnzD3Mz+HfV5ki8uyH2VkqUSuP0KO+5i1lF8y/779y1pqXjtMVaNawto4Qfn8onDLMu8ZiwoI/buJfROvp4tr8K6UANyzWfxUUBvaHNkzMz5X0izkulJ2i2/9Zjcdj6DsHkeninWFt9F//169q7D5x7KK6LhEl6xL3yYGrHX2/vzLefoZZkxOEtb87TUp4hrxF6A1i9dWC1oITEw4a4n8nvWNBOtQQkBWpk7pEmMrPNZYcdbvJq8Jd9MuVvPHuIDoJjPkKXD/nxPngTfC+E2eT1h00iPhHPR/5mImgWfsrQ5/Clrf75FellmDG/Nx5CWqp15pHTxeWT6maKk0XphxXqWhHzRMXPU3yYPiIUDt+S3d5uJ1pKolo2kDrLMvtR1oc7zqFlhJyhNbo7Im9e0gfYPb3wFGz78+AFb+o3/eTvvv38H69L5KPkDiztsEjOt3b0/4JkI5wyf9Lk9+Blrf75HHIYFNcaQ1s88kl18f2FR46hXdL74vBvmFqvildjkk8B/bfHH6Z/MO7C79YozR7J+6oeoshjsJTqbmiwo96x4rLATJj4i4yFeqj3ORw7/QdZVu+Z/Kk5tWu168phWQVZsOS2+DpT/M9EtqLU/v1E7c3irPkZbHe56pdqMLBzUNY56PceV+mW54BXvY97d+q1zxvyDlOa6GSEeGmn4UXcZz8Ch5hV2AsVHZHwH+VPni6/j3Xf/lzdo+J+6UzufOPHaw+e+OuyZCLtzL2uyvNHen++j6vDWrBijrQx3/fBnfm+lGVl08dU46htTz8dWb6/QbFx8/2ewsXyszR+HBR1HO32SXP1qA32Jj8j4T+S+hVxI9G6+FsSDWeHU/qBo5D95LNFY3x9mQdVWfNv+fEOVV3jDK6auZmS5PnqNo17JqqUTWV3witXAfx15824pBsB8gS1D/goDtI+J7Z0kx87S+3TjjQ2rDfQlMS2dkH+0eIC5Sd+3PDh9kf35vNHGJ8y5KCi4diq9Dj26W5xSurJyVXlgLiZaqnyA3LQ0IyW6Hr17+jAcrZF0VBzmI5vLHoyZb6eMXWGO+sbNZAeW9KW/jd6InzQX6eA+evZxm/eO9PwOKW7S/E+lkc/5kNUL+rivvJPtIlczD6QnGV1ZB/9N94eV44wFxDXNyGJKY2167oGMktUBpii16uocbmSPW7JFXbR4f9mYPcF99Leuso9rAwBakyW7j15O/HF5UftQ2ZW1Ofy31AJ+lDbgxB0ipT27h22D8ifFrevajOw8FLyF2gwWycbJmpn4o4sjYUFfypx8m8//n5nyosiOvC+n35/tyVHvIdHIt/roxc26+J7ZTw91s9SuLPL7Xrdai/Zz+UqwEUXk95fboPBb1aUZGTAUXN81p4NBTciCMkeGWOrmXtlxrtSC8vFevHL1fS0d9XqfYyWGbblpWN7/eZs18m/LuRdc4q+80ZSt754P9bIoXVn/jPy9xYpvC0b5OTiV3vrc3HlNLvaS91Bw0Z00+7Mn64Of6VbLCayDysewhzpoOR6irOUo3cjFeC9euWrnqJf+HnKUp1VeJO+J+XOstPyjZtuINvJZS/+O2THKV9w4f/hHyZ0e2uX2/JZdWV9Ma8IXx3zA3Of/U7EwRrHeQrENSg82xXMouBxt9VbWnTS3z3b1VVgr3mti+zCyrL+gaSObRrxy1aqGpXnMdecdr+2J0vJ3MCf97ymbRtxrzT4Ez1vyamFBV53mgfipmIr6jtddeWiVL3qcL4wh3rdrp3l1eESbIp3CzAfaundMKhk/aPPsbT4ikax45apNDUvrc9Rc7fwIL0Fpafmh5eHH2QTNStNI9Ef/6o3fdTbmyDuhi3eTb6/YD27u3i0sXdCYpe7ZkRb0lcxmfF+73jGptAAtFlUbwhPrtqAybVaCstKSNTqsTSMxVf3x9gObJiMxz/Uvs2GmX9i+d4wpGUC5xLjH67ceXXzLAC76vA66EgZAqYPm9QeJ6q1K0ygPx3/bKEcsbvT+pDWV43ojRP2mh1pOeoDulnd4g/5l/deD9Va8WtHmFmEz+1eytOT9n3Jauibxm/g03ei923zeVGar6ayvKC1l1deQtZ9jEIvSA/R8wQddbq/2NS2rjYqmkfUA/1Td6M8NYUHVnc/u4S3l0tfwJXk3cNddfPeu9AAVFlSshLTHUQFNUt3ow0z3U9et59uUkdLXQGvKqst+vK6L3pUaoOxu388x7d1rkk+U6KdDWZ8RMqQFZY1kwodfvqn0NZwKl33Pcwz2oLQAzTijL10cDdFTICdKNO5c4SnFjf7AMI0kMQvuJX+X5vSq3JJM8TVwl33fcwzGV3KADiffnSt8tdFmhPSSRUO8kfyj9IPzOTd8Dcxl3/8cg7EFQAv57lwRLvsiX/3L8DWI3/qeYzCyAGgh350roDEFQAv57lwBjSkAWmi8nSsgfwFQKGoBUChqAVAoagFQKGoBUChqAVAoagFQKGoBUChqAVAoagFQKGoBUChqAVAoagFQKGoBUChqAVAoagFQKGoBUChqAVAoagFQKGoBUChqAVAoagFQKGoBUChqAVAoagFQKGoBUChqAVAoagFQKGoBUChqAVAoagFQKGoBUChqAVAoagFQKGoBUChqAVAoagFQKGoBUChqAVAoagFQKGoBUChqAVAoagFQKGoBUChqAVAoagFQKGoBUChqAVAoagFQKGoBUChqAVAoagFQKGoBUChqAVAoagFQKGoBUChqAVAoagFQKGoBUChqAVAoagFQKGoBUChqAVAoagFQKGoBUChqAVAoagFQKGoBUChqAVAoagFQKGoBUChqAVAoagFQKGoBUChqAVAoagFQKGoBUChqAVAoagFQKGoBUChqAVAoagFQKGoBUChqAVAoagFQKGoBUChqAVAoagFQKGoBUChqAVAoagFQKGpdTkA3hBxVftyuij93y1XdYV1m4NqTL47pX5t5eeT84RP6X2OOLVGrGRKx7N7iG1E6upSA7pZVPLWHb2HMhp39SO3JlM3t7L1/Y1kg2hpQLRkZy/bwzDOmZHRJAbXANgqg/I+L44PT4lCvgHL7PC1dRkDPF4RQRNaEkJX8Slbsk9ofWviTOXv4/Pmzj8phan13b3kvOfjZ4zklggX++wsRU8PJVFuG5vbwh8syfvedp/S//Fx6UKRwvrizpH+c85jPH/6xhUiXxSvyYGQoj2VyJvQyAiqe85risJmd0Ce9YlgIqNgPtAKgMFY5fL44or8rIOyW9NeN/L/mZCaWaLZenf/1UyNL8lwWmP47p6mwCNl7tDk4pTCu5JGVkgclQ7m2s6nVQi8toLxBwQDayvKW/ygrpwpj1cP0F60Sy7/QmBpOLoLacyQOXBzzFGYnnDr5sRIIUuvIoy7yoGQoj4e/EZPSpQWUaUu4VRLPV5TIOUgFY+phYZ84iysjttxcuk9W/60oP1f8y5lcyW/5F5Y6Y17NQ/GlzIvjDUhWlxdQWns7+OCCt1kIkcVn3lxRq5HKYVY/ZHIAWn8yk9PA5eeKADntBaD8qARUzUPxpcwLAJ2ACmNZALPmD99mQdXDRQ3P14KqJ1fOU9VgQVVA1TxUqpwAdBLiz5a3p3PbI6HSqpFHmQms7i1SYyvOcJ8s/vSvg2pFPPt1LeugSh4qwKMOOgnlxnK3JEfCCnHrdCRaxRfHcxrg4vjwjBbQq8ph1SIWsRXt65qTmdZze47yc5VWvAYoPaq24kUelAzl0aAVPwnlddDZyZo/efYXfc6aH5TRS+7Iep52mJpe6W/P/aCrMsq6kzO1wc3OVFXxg2qASk9rkQqLRs1QEQv8oFAXKab3/A3eZ3kX3O7urmQFQMdVOU5k69+c8QYUffFQR5W95U/51xZ9AcVoJggaWQAUilr/H6oJrk9UMyiqAAAAAElFTkSuQmCC" style="display: block; margin: auto;" /></p>
<p>We cut the dendrogram at the height of the red dashed horizontal line to achieve 6 clusters, four of reasonable size and two minor clusters.</p>
<!-- TODO: Continue here -->
<p>We proceed with calculating the barycenters with <code>dba</code> and plot these in the next figure:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">lprotos &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="cf">function</span>(i){</a>
<a class="sourceLine" id="cb24-2" title="2">   subix  &lt;-<span class="st"> </span><span class="kw">which</span>(myclus <span class="op">==</span><span class="st"> </span>i)</a>
<a class="sourceLine" id="cb24-3" title="3">   sublot &lt;-<span class="st"> </span>lot[subix]</a>
<a class="sourceLine" id="cb24-4" title="4">   subdm &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(dm<span class="op">$</span>dismat)[subix, subix]</a>
<a class="sourceLine" id="cb24-5" title="5">   m0  &lt;-<span class="st"> </span>sublot[[ <span class="kw">which.min</span>(<span class="kw">apply</span>(subdm, <span class="dv">1</span>, sum)) ]]</a>
<a class="sourceLine" id="cb24-6" title="6">   IncDTW<span class="op">::</span><span class="kw">dba</span>(<span class="dt">m0 =</span> m0, <span class="dt">lot =</span> sublot, <span class="dt">dist_method =</span> <span class="st">&quot;norm2&quot;</span>)</a>
<a class="sourceLine" id="cb24-7" title="7">})</a>
<a class="sourceLine" id="cb24-8" title="8"></a>
<a class="sourceLine" id="cb24-9" title="9">protos &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="cf">function</span>(i){</a>
<a class="sourceLine" id="cb24-10" title="10">   <span class="kw">cbind</span>(<span class="dt">i =</span> i, lprotos[[i]]<span class="op">$</span>m1)</a>
<a class="sourceLine" id="cb24-11" title="11">})</a></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="kw">theme_set</span>(<span class="kw">theme_gray</span>(<span class="dt">base_size =</span> <span class="dv">9</span>))</a>
<a class="sourceLine" id="cb25-2" title="2"><span class="kw">ggplot</span>(dfp_uel) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> value, <span class="dt">group =</span> variable, <span class="dt">col =</span> variable)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-3" title="3"><span class="st">   </span><span class="kw">facet_wrap</span>(<span class="op">~</span>i, <span class="dt">scales =</span> <span class="st">&quot;free_x&quot;</span>, <span class="dt">nrow =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-4" title="4"><span class="st">   </span><span class="kw">ylab</span>((<span class="kw">bquote</span>(<span class="st">&#39;Acceleration (&#39;</span> <span class="op">~</span><span class="st"> </span>m<span class="op">/</span>s<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="st">&#39;)&#39;</span>)))<span class="op">+</span></a>
<a class="sourceLine" id="cb25-5" title="5"><span class="st">   </span><span class="kw">theme</span>(<span class="dt">text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Time (ms)&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>All time series are records of the same activity, so as expected the clusters show similar patterns but differ from each other in detail. Further the cluster centers show different lengths of 300 to 800 observations. The most representative pattern shows cluster 5, the biggest cluster. One can interpret the figure as tripartite: (1) The first few seconds describe the lifting of the glass. Due to the movement of the hand the axis subtend each other. (2) The middle part of the figure shows a rather constant pattern, where the hand remains inactive. (3) Putting back the glass onto the table show the opposite movement to the first. The forth cluster is a smaller one and shows that some time series possibly are records where the glass was lifted multiple times for multiple smaller sips.</p>
<p>    <!-- ========================================================================================== --> <!-- ========================================================================================== --></p>
</div>
<div id="runtime-comparison" class="section level2">
<h2>Runtime comparison</h2>
<!-- ========================================================================================== -->
<!-- ========================================================================================== -->
<p>To cluster or classify a set of time series by their pairwise DTW distance measures we need a distance matrix. The function <code>IncDTW::dtw_dismat</code> helps to get this matrix for a list of univariate or multivariate time series of possibly different lengths. The calculations can be performed single threaded (<code>ncores = 1</code>) or multihreaded.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1">REPETITIONS &lt;-<span class="st">  </span><span class="dv">30</span><span class="co"># times parameter for micorbenchmark</span></a>
<a class="sourceLine" id="cb26-2" title="2">THRESHOLD &lt;-<span class="st"> </span><span class="dv">10</span><span class="op">*</span><span class="dv">60</span> <span class="op">*</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span><span class="dv">9</span><span class="co"># 10 minute in nano seconds</span></a>
<a class="sourceLine" id="cb26-3" title="3"></a>
<a class="sourceLine" id="cb26-4" title="4">NCOL &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb26-5" title="5">NLOT &lt;-<span class="st"> </span><span class="dv">500</span><span class="co"># number of time series</span></a>
<a class="sourceLine" id="cb26-6" title="6">SEQ0 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">300</span>, <span class="dv">600</span>, <span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb26-7" title="7">SP &lt;-<span class="st"> &quot;symmetric1&quot;</span> </a>
<a class="sourceLine" id="cb26-8" title="8">DM &lt;-<span class="st"> &quot;norm2&quot;</span></a>
<a class="sourceLine" id="cb26-9" title="9">NORM &lt;-<span class="st"> </span><span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb26-10" title="10">WS &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb26-11" title="11"></a>
<a class="sourceLine" id="cb26-12" title="12"></a>
<a class="sourceLine" id="cb26-13" title="13">my_check &lt;-<span class="st"> </span><span class="cf">function</span>(values) {</a>
<a class="sourceLine" id="cb26-14" title="14">   <span class="kw">all</span>(<span class="kw">sapply</span>(values[<span class="op">-</span><span class="dv">1</span>], <span class="cf">function</span>(x) <span class="kw">identical</span>(values[[<span class="dv">1</span>]], x)))</a>
<a class="sourceLine" id="cb26-15" title="15">}</a>
<a class="sourceLine" id="cb26-16" title="16"></a>
<a class="sourceLine" id="cb26-17" title="17">cond_mic &lt;-<span class="st"> </span><span class="cf">function</span>(expr, df, repetitions, threshold, nn){</a>
<a class="sourceLine" id="cb26-18" title="18">   <span class="co"># conditional microbenchmark</span></a>
<a class="sourceLine" id="cb26-19" title="19">   <span class="cf">if</span>(df[df<span class="op">$</span>expr <span class="op">==</span><span class="st"> </span>expr, <span class="st">&quot;doit&quot;</span>]){</a>
<a class="sourceLine" id="cb26-20" title="20">      mic &lt;-<span class="st"> </span>microbenchmark<span class="op">::</span><span class="kw">microbenchmark</span>(<span class="kw">eval</span>(<span class="kw">parse</span>(<span class="dt">text =</span> expr)),</a>
<a class="sourceLine" id="cb26-21" title="21">                                            <span class="dt">times =</span> repetitions,</a>
<a class="sourceLine" id="cb26-22" title="22">                                            <span class="dt">check =</span> my_check)</a>
<a class="sourceLine" id="cb26-23" title="23">      mic &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">expr =</span> expr, <span class="dt">times =</span> mic<span class="op">$</span>time,</a>
<a class="sourceLine" id="cb26-24" title="24">                        <span class="dt">nn=</span>nn, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb26-25" title="25">      <span class="cf">if</span>(<span class="kw">median</span>(mic<span class="op">$</span>time) <span class="op">&gt;</span><span class="st"> </span>threshold){</a>
<a class="sourceLine" id="cb26-26" title="26">         df[df<span class="op">$</span>expr <span class="op">==</span><span class="st"> </span>expr, <span class="st">&quot;doit&quot;</span>] &lt;-<span class="st"> </span><span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb26-27" title="27">      }</a>
<a class="sourceLine" id="cb26-28" title="28">   }<span class="cf">else</span>{</a>
<a class="sourceLine" id="cb26-29" title="29">      mic &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">expr =</span> <span class="kw">rep</span>(expr, repetitions), <span class="dt">times =</span> <span class="ot">NA</span>, </a>
<a class="sourceLine" id="cb26-30" title="30">                        <span class="dt">nn=</span>nn, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb26-31" title="31">   }</a>
<a class="sourceLine" id="cb26-32" title="32">   <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">mic =</span> mic, <span class="dt">df =</span> df))</a>
<a class="sourceLine" id="cb26-33" title="33">}</a>
<a class="sourceLine" id="cb26-34" title="34"></a>
<a class="sourceLine" id="cb26-35" title="35"></a>
<a class="sourceLine" id="cb26-36" title="36">f0 &lt;-<span class="st"> </span><span class="cf">function</span>(lot){<span class="kw">dtw_dismat</span>(lot, <span class="dt">ws =</span> WS, <span class="dt">step_pattern =</span> SP, <span class="dt">dist_method =</span> DM, </a>
<a class="sourceLine" id="cb26-37" title="37">   <span class="dt">normalize =</span> NORM, <span class="dt">ncores =</span> <span class="dv">1</span>, <span class="dt">return_matrix =</span> <span class="ot">FALSE</span>)<span class="op">$</span>dismat}</a>
<a class="sourceLine" id="cb26-38" title="38"></a>
<a class="sourceLine" id="cb26-39" title="39">fcp &lt;-<span class="st"> </span><span class="cf">function</span>(lot){<span class="kw">dtw_dismat</span>(lot, <span class="dt">ws =</span> WS, <span class="dt">step_pattern =</span> SP, <span class="dt">dist_method =</span> DM, </a>
<a class="sourceLine" id="cb26-40" title="40">   <span class="dt">normalize =</span> NORM, <span class="dt">ncores =</span> <span class="dv">3</span>, <span class="dt">return_matrix =</span> <span class="ot">FALSE</span>, <span class="dt">useRcppParallel =</span> <span class="ot">TRUE</span>)<span class="op">$</span>dismat}</a>
<a class="sourceLine" id="cb26-41" title="41"></a>
<a class="sourceLine" id="cb26-42" title="42">frp &lt;-<span class="st"> </span><span class="cf">function</span>(lot){<span class="kw">dtw_dismat</span>(lot, <span class="dt">ws =</span> WS, <span class="dt">step_pattern =</span> SP, <span class="dt">dist_method =</span> DM, </a>
<a class="sourceLine" id="cb26-43" title="43">   <span class="dt">normalize =</span> NORM, <span class="dt">ncores =</span> <span class="dv">3</span>, <span class="dt">return_matrix =</span> <span class="ot">FALSE</span>, <span class="dt">useRcppParallel =</span> <span class="ot">FALSE</span>)<span class="op">$</span>dismat}</a>
<a class="sourceLine" id="cb26-44" title="44"></a>
<a class="sourceLine" id="cb26-45" title="45">fpp &lt;-<span class="st"> </span><span class="cf">function</span>(lot){parallelDist<span class="op">::</span><span class="kw">parDist</span>(<span class="dt">x=</span>lot, <span class="dt">window.size =</span> WS, <span class="dt">method =</span> <span class="st">&quot;dtw&quot;</span>, </a>
<a class="sourceLine" id="cb26-46" title="46">   <span class="dt">step.pattern =</span> dtw<span class="op">::</span>symmetric1, <span class="dt">threads =</span> <span class="dv">3</span>)}</a>
<a class="sourceLine" id="cb26-47" title="47"></a>
<a class="sourceLine" id="cb26-48" title="48">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">expr =</span> <span class="kw">c</span>(<span class="st">&quot;f0(lot)&quot;</span>, <span class="st">&quot;fcp(lot)&quot;</span>, <span class="st">&quot;frp(lot)&quot;</span>, <span class="st">&quot;fpp(lot_t)&quot;</span>),</a>
<a class="sourceLine" id="cb26-49" title="49">   <span class="dt">doit =</span> <span class="ot">TRUE</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb26-50" title="50"></a>
<a class="sourceLine" id="cb26-51" title="51"></a>
<a class="sourceLine" id="cb26-52" title="52">mics &lt;-<span class="st"> </span><span class="kw">list</span>()</a>
<a class="sourceLine" id="cb26-53" title="53">nn &lt;-<span class="st"> </span><span class="dv">20</span>; i &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb26-54" title="54">tic &lt;-<span class="st"> </span><span class="kw">Sys.time</span>()</a>
<a class="sourceLine" id="cb26-55" title="55"><span class="kw">print</span>(tic)</a>
<a class="sourceLine" id="cb26-56" title="56"></a>
<a class="sourceLine" id="cb26-57" title="57"><span class="cf">for</span>(nn <span class="cf">in</span> SEQ0){</a>
<a class="sourceLine" id="cb26-58" title="58">   </a>
<a class="sourceLine" id="cb26-59" title="59">   <span class="co"># simulate the list of time series</span></a>
<a class="sourceLine" id="cb26-60" title="60">   <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;---------------------&quot;</span>, nn, <span class="st">&quot;--------------------&quot;</span>))</a>
<a class="sourceLine" id="cb26-61" title="61">   lot &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span>NLOT, <span class="cf">function</span>(i){</a>
<a class="sourceLine" id="cb26-62" title="62">      <span class="kw">matrix</span>(<span class="kw">rnorm</span>(nn <span class="op">*</span><span class="st"> </span>NCOL, <span class="kw">log</span>(i),<span class="dv">1</span>), <span class="dt">ncol =</span> NCOL)</a>
<a class="sourceLine" id="cb26-63" title="63">   })</a>
<a class="sourceLine" id="cb26-64" title="64">   lot_t &lt;-<span class="st"> </span><span class="kw">lapply</span>(lot, t)</a>
<a class="sourceLine" id="cb26-65" title="65">   </a>
<a class="sourceLine" id="cb26-66" title="66">   <span class="co"># get the dist matrices (runtimes) for each function</span></a>
<a class="sourceLine" id="cb26-67" title="67">   <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(df)){</a>
<a class="sourceLine" id="cb26-68" title="68">      <span class="kw">print</span>(df[i, ])</a>
<a class="sourceLine" id="cb26-69" title="69">      tmp &lt;-<span class="st"> </span><span class="kw">cond_mic</span>(df<span class="op">$</span>expr[i], df, REPETITIONS, THRESHOLD, nn)</a>
<a class="sourceLine" id="cb26-70" title="70">      df &lt;-<span class="st"> </span>tmp<span class="op">$</span>df</a>
<a class="sourceLine" id="cb26-71" title="71">      mics[[<span class="kw">length</span>(mics)<span class="op">+</span><span class="dv">1</span>]] &lt;-<span class="st"> </span>tmp<span class="op">$</span>mic</a>
<a class="sourceLine" id="cb26-72" title="72">   }</a>
<a class="sourceLine" id="cb26-73" title="73">}</a>
<a class="sourceLine" id="cb26-74" title="74"></a>
<a class="sourceLine" id="cb26-75" title="75">mics &lt;-<span class="st"> </span><span class="kw">do.call</span>(rbind, mics)</a></code></pre></div>
<pre><code>## Loading objects:
##   mics
##   NLOT</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1">dfp_run &lt;-<span class="st"> </span><span class="kw">as.data.table</span>(mics)</a>
<a class="sourceLine" id="cb28-2" title="2">dfp_run &lt;-<span class="st"> </span>dfp_run[, <span class="kw">list</span>(<span class="dt">Runtime_sec =</span> <span class="kw">median</span>(times)<span class="op">/</span><span class="dv">10</span><span class="op">^</span><span class="dv">9</span>), by =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;expr&quot;</span>, <span class="st">&quot;nn&quot;</span>)]</a>
<a class="sourceLine" id="cb28-3" title="3"></a>
<a class="sourceLine" id="cb28-4" title="4"></a>
<a class="sourceLine" id="cb28-5" title="5">dfp_run<span class="op">$</span>Function &lt;-<span class="st"> </span><span class="kw">factor</span>(dfp_run<span class="op">$</span>expr, <span class="dt">levels =</span> <span class="kw">c</span>( <span class="st">&quot;fcp(lot)&quot;</span>, <span class="st">&quot;frp(lot)&quot;</span>,</a>
<a class="sourceLine" id="cb28-6" title="6">                                             <span class="st">&quot;f0(lot)&quot;</span>, <span class="st">&quot;fpp(lot_t)&quot;</span>))</a>
<a class="sourceLine" id="cb28-7" title="7"><span class="kw">levels</span>(dfp_run<span class="op">$</span>Function) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;dtw_dismat_3Rcpp&quot;</span>, <span class="st">&quot;dtw_dismat_3R&quot;</span>, </a>
<a class="sourceLine" id="cb28-8" title="8">                          <span class="st">&quot;dtw_dismat_1&quot;</span>, <span class="st">&quot;parDist_3&quot;</span>)</a>
<a class="sourceLine" id="cb28-9" title="9"><span class="kw">levels</span>(dfp_run<span class="op">$</span>Function) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;IncDTW::dtw_dismat_3Rcpp&quot;</span>,</a>
<a class="sourceLine" id="cb28-10" title="10">                          <span class="st">&quot;IncDTW::dtw_dismat_3R&quot;</span>,</a>
<a class="sourceLine" id="cb28-11" title="11">                          <span class="st">&quot;IncDTW::dtw_dismat_1&quot;</span>,</a>
<a class="sourceLine" id="cb28-12" title="12">                          <span class="st">&quot;parallelDist::parDist_3&quot;</span>)</a></code></pre></div>
<p>We compare the run times for calculating distance matrices for a set of 500 time series of varying lengths and also set the window size parameter to 10. The next figure depicts the run times, where <code>dtw_dismat_1</code> is the standard function <code>dis_mat</code> without parallelization. <code>dtw_dismat_3Rcpp</code> splits the work via <code>RcppParallel</code> and <code>dtw_dismat_3R</code> uses the package <code>parallel</code>, both with three cores (<code>ncores = 3</code>). For short time series <code>parDist_3</code> is up to 10 times faster than <code>dtw_dismat_3Rcpp</code> and for long time series it’s the other way round (about 25 times faster).</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="kw">theme_set</span>(<span class="kw">theme_gray</span>(<span class="dt">base_size =</span> <span class="dv">9</span>))</a>
<a class="sourceLine" id="cb29-2" title="2"><span class="kw">ggplot</span>(dfp_run) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> nn, <span class="dt">y =</span> Runtime_sec, <span class="dt">col=</span>Function, <span class="dt">group =</span> Function))<span class="op">+</span></a>
<a class="sourceLine" id="cb29-3" title="3"><span class="st">         </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> nn, <span class="dt">y =</span> Runtime_sec, <span class="dt">col=</span>Function))<span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Runtime (sec)&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb29-4" title="4"><span class="st">         </span><span class="kw">scale_y_log10</span>() <span class="co">#+ theme(legend.position = c(0.8, 0.2))</span></a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Run time comparison for calculating matrices of pairwise DTW distances.</p>
<p>    <!-- ========================================================================================== --> <!-- ========================================================================================== --></p>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<!-- ========================================================================================== -->
<!-- ========================================================================================== -->
<div id="refs" class="references">
<div id="ref-R_RcppParallel">
<p>Allaire, JJ, Romain Francois, Kevin Ushey, Gregory Vandenbrouck, Marcus Geelnard, and Intel. 2018. <em>RcppParallel: Parallel Programming Tools for Rcpp</em>. <a href="https://CRAN.R-project.org/package=RcppParallel">https://CRAN.R-project.org/package=RcppParallel</a>.</p>
</div>
<div id="ref-UCI_ADL">
<p>Bruno, Barbara, Fulvio Mastrogiovanni, Antonio Sgorbissa, Tullio Vernazza, and Renato Zaccaria. 2013. “Analysis of Human Behavior Recognition Algorithms Based on Acceleration Data.” In <em>Robotics and Automation (Icra), 2013 Ieee International Conference on</em>, 1602–7. IEEE.</p>
</div>
<div id="ref-UCI">
<p>Dheeru, Dua, and Efi Karra Taniskidou. 2017. “UCI Machine Learning Repository.” University of California, Irvine, School of Information; Computer Sciences. <a href="http://archive.ics.uci.edu/ml">http://archive.ics.uci.edu/ml</a>.</p>
</div>
<div id="ref-R_cluster">
<p>Maechler, Martin, Peter Rousseeuw, Anja Struyf, Mia Hubert, and Kurt Hornik. 2018. <em>Cluster: Cluster Analysis Basics and Extensions</em>.</p>
</div>
<div id="ref-R_fastcluster">
<p>Müllner, Daniel. 2013. “Fastcluster: Fast Hierarchical, Agglomerative Clustering Routines for R and Python.” <em>Journal of Statistical Software</em> 53 (9): 1–18. <a href="http://www.jstatsoft.org/v53/i09/">http://www.jstatsoft.org/v53/i09/</a>.</p>
</div>
<div id="ref-Petitjean2011">
<p>Petitjean, François, Alain Ketterlin, and Pierre Gançarski. 2011. “A Global Averaging Method for Dynamic Time Warping, with Applications to Clustering.” <em>Pattern Recogn.</em> 44 (3): 678–93. <a href="https://doi.org/10.1016/j.patcog.2010.09.013">https://doi.org/10.1016/j.patcog.2010.09.013</a>.</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
